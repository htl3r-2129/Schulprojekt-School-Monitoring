<!doctype html>
<html lang="de">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Viewport</title>
  <!--style was generated by Chatgpt and should be changed!-->

  <style>
    :root {
      --gap: 18px;
    }

    html,
    body {
      height: 100%;
      margin: 0;
      font-family: "Segoe UI", Roboto, Arial, sans-serif;
      background: #fff;
      color: #000;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* Gesamtes Viewport-Layout */
    .slides {
      height: 100vh;
      width: 100%;
      overflow: hidden;
      position: relative;
    }

    /* Innerer Container, den wir vertikal verschieben */
    .slides-inner {
      height: 100%;
      transition: transform 0.75s cubic-bezier(.22, .9, .3, 1);
      will-change: transform;
    }

    /* Einzelne Slide - nimmt ganze Höhe */
    .slide {
      height: 100vh;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      padding: 28px;
      gap: 8px;
    }

    /* Titel */
    .slide h1 {
      margin: 0;
      font-weight: 400;
      padding-bottom: 12px;
      border-bottom: 2px solid #000;
      font-size: clamp(28px, 4.6vw, 64px);
    }

    /* Optionaler Text - wird nicht gerendert wenn leer (wir erstellen ihn nur bei Inhalt) */
    .slide .text {
      margin: 6px 0 0 0;
      font-size: clamp(18px, 2.8vw, 36px);
      padding-bottom: 10px;
      border-bottom: 2px solid #000;
    }

    /* Video-Container */
    .video-wrap {
      margin-top: 12px;
      flex: 1 1 auto;
      border: 4px solid #000;
      box-sizing: border-box;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .video-wrap video {
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
      pointer-events: none;
      /* Keine Klicks auf Video */
    }

    /* Platzhalter wenn kein Video vorhanden */
    .video-placeholder {
      font-size: clamp(20px, 3vw, 48px);
    }

    /* Optional: keine Interaktionen auf der ganzen Seite */
    body {
      -webkit-user-select: none;
      user-select: none;
    }

    .slides,
    .slide {
      pointer-events: none;
    }

    @media (max-width:600px) {
      .slide {
        padding: 16px;
      }

      .slide h1 {
        font-size: clamp(20px, 8vw, 40px);
      }
    }
  </style>
</head>

<body>

  <div class="slides" id="slides">
    <div class="slides-inner" id="slidesInner">
    </div>
  </div>

<!--Here beginns the js sript-->

  <script>

    //++++++++++++++++++++ DATA CRATION ++++++++++++++++++++

    const titles = ["Wasser", "Feuer", "Instant", "Erde"]; //Mandatory!

    const texts = [
      "Feuchtigkeit ist wichtig",
      "Grrrrrr",
      "Ich mag Erde und dies ist eine Instant Nachricht!",
      ""
    ];

    const media = [
      { type: "video", src: "./media/Videos/WALKWAY0025-0220.mp4", instant: false },
      { type: "image", src: "./media/Images/Houser.jpg", instant: false },
      { instant: true },
      { type: "image", src: "./media/Images/Houser.jpg", instant: false }
    ];

    //++++++++++++++++++++ TIME-CONTROL ++++++++++++++++++++

    //default time
    const slideDurationSeconds = 1;
    //instant time
    const instantDurationSeconds = 10;
  

    //++++++++++++++++++++ Slide Creation ++++++++++++++++++++
    
    const slidesInner = document.getElementById('slidesInner');
    const n = titles.length;
    const slideData = []; //Regestry 

    for (let i = 0; i < n; i++) {
      const slide = document.createElement('section');
      slide.className = 'slide';
      slide.dataset.index = i;

      //++++++ TITLE CONTROL ++++++ 
      const h = document.createElement('h1');
      h.textContent = titles[i];
      slide.appendChild(h);

      //++++++ TEXT CONTROL ++++++
      if (texts[i] && texts[i].trim() !== "") {
        const d = document.createElement('div');
        d.className = 'text';
        d.textContent = texts[i];
        slide.appendChild(d);
      }


      
      //++++++ MEDIA CONTROL ++++++
      let videoRef = null;

      if (media[i] !== null && media[i] !== undefined && (media[i].type === "video" || media[i].type === "image")) {
        const wrap = document.createElement('div');
        wrap.className = 'video-wrap';

        if (media[i]?.type === "video") {
          const video = document.createElement('video');
          video.src = media[i].src;
          video.preload = 'auto';
          video.muted = true;
          video.loop = false;
          video.playsInline = true;

          video.addEventListener("ended", () => {
            if (slideData[currentIndex]?.video === video) {
              goTo(currentIndex + 1);
            }
          });

          wrap.appendChild(video);
          videoRef = video;
        }
        else if (media[i]?.type === "image") {
          const img = document.createElement('img');
          img.src = media[i].src;
          img.alt = titles[i];
          img.style.width = "100%";
          img.style.height = "100%";
          img.style.objectFit = "contain";
          img.draggable = false;
          wrap.appendChild(img);
        }

        slide.appendChild(wrap); //Activiates Media Container
      }

      slidesInner.appendChild(slide);
      slideData.push({ slide, video: videoRef });
    }

    //++++++ TIME CONTROL ++++++
    function getDurationMs(i) {
      // instant
      if (media[i].instant === true) {
        return Number(instantDurationSeconds) * 1000;
      }

      // global
      return Number(slideDurationSeconds) * 1000;
    }

    //++++++ SLIDE CONTROL ++++++
    let currentIndex = 0;
    let autoTimer = null;

    function goTo(index) {
      if (index < 0) index = slideData.length - 1;
      if (index >= slideData.length) index = 0;

      currentIndex = index;

      const y = - index * window.innerHeight;
      slidesInner.style.transform = `translateY(${y}px)`;

      //Stops all videos (again) to play the selected one (-> idiotic)
      slideData.forEach((sd, idx) => {
        if (sd.video) {
          try {
            if (idx === index) {
              sd.video.currentTime = 0;
              const playPromise = sd.video.play();
              if (playPromise && typeof playPromise.then === 'function') {
                playPromise.catch(() => { });
              }
            } else {
              sd.video.pause();
            }
          } catch (e) {
            console.warn('Video play/pause Fehler', e);
          }
        }
      });

      scheduleNext();
    }


    //++++++++ Timer Managment ++++++++++ --> do not touch
    function scheduleNext() {
      clearTimeout(autoTimer);

      const sd = slideData[currentIndex];
      
      //Video Managment
      if (sd.video) return;

      //General Managment
      const ms = getDurationMs(currentIndex);
      autoTimer = setTimeout(() => goTo(currentIndex + 1), ms);
    }



    //++++++++ Window Managment ++++++++++ --> please touch

    /* Bei Größenänderung neu-positionieren (z.B. Fenster-Resize) */
    window.addEventListener('resize', () => {
      // setze transform neu (weil 100vh könnte sich ändern)
      const y = - currentIndex * window.innerHeight;
      slidesInner.style.transform = `translateY(${y}px)`;
    });

    
    //++++++++ Transision Managment ++++++++++
    document.addEventListener('visibilitychange', () => {
      if (document.hidden) {
        clearTimeout(autoTimer);
        //stops all vids
        slideData.forEach(sd => sd.video && sd.video.pause());
      } else {
        //play current video und schedule next
        const sd = slideData[currentIndex];
        if (sd && sd.video) {
          sd.video.play().catch(() => { });
        }
        scheduleNext();
      }
    });

    //Initializer
    goTo(0);

    window.goToSlide = (i) => goTo(i);
    window.getSlideCount = () => slideData.length;

  </script>
</body>

</html>